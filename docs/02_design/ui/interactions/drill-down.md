# ドリルダウン挙動仕様

## ドリルダウンのトリガー

| 要素 | トリガー | 遷移先 |
|------|---------|--------|
| KPIカード（タブ1） | クリック | 対応するタブに切替（例: 売上→タブ2、サブスク→タブ3） |
| チャネル構成比ドーナツ（タブ1） | セグメントクリック | チャネルフィルタを該当チャネルに設定 + タブ2に切替 |
| 日次売上折れ線の特定日（タブ1） | クリック | タブ9（時系列比較）に切替、該当日を中心に表示 |
| 商品カテゴリツリーマップ（タブ7） | セグメントクリック | カテゴリフィルタを設定して商品テーブルを絞り込み（同一タブ内） |
| コホートヒートマップのセル（タブ3） | クリック | モーダルでそのコホート月×経過月数の顧客リスト表示 |
| データテーブルの行（全タブ） | クリック | モーダルで詳細データ表示 |

## 遷移方式

| パターン | 方式 | 使用箇所 |
|---------|------|---------|
| タブ間遷移 | タブ切替 + フィルタ自動設定 | KPIカード→対応タブ、ドーナツ→チャネル詳細 |
| 同一タブ内絞り込み | フィルタ値を変更（URL更新） | カテゴリツリーマップ→商品テーブル |
| モーダル表示 | ダイアログで詳細表示 | コホートセル、テーブル行 |

## 戻る操作

| 方式 | 実装 |
|------|------|
| タブ間遷移 | ブラウザバックでURL復元（フィルタ状態も復元） |
| モーダル | 「×」ボタン or ESCキー or 背景クリックで閉じる |
| フィルタ絞り込み | リセットボタン or ブラウザバック |

## アニメーション

| 遷移 | アニメーション | 時間 |
|------|-------------|------|
| タブ切替 | フェードイン | 200ms |
| モーダル表示 | フェードイン + スケール | 150ms |
| モーダル閉じる | フェードアウト | 150ms |

## ドリルダウンデータの取得

- 遅延読み込み: ドリルダウン操作時にAPIを呼び出し
- ローディング表示: 対象領域にスピナー表示
- エラー時: エラーメッセージ + リトライボタン
- タブ間遷移の場合: 遷移先タブのデータはTanStack Queryが管理（キャッシュあればキャッシュから）
