# AI生成コードでよくある失敗パターン

## 1. ハルシネーション（存在しないものの参照）

### パターン
- 存在しないnpmパッケージのimport
- 存在しないAPIメソッドの使用
- 廃止されたライブラリバージョンの参照

### 対策
- 新しいimportを追加した場合は `npm ls パッケージ名` で存在確認
- API仕様は公式ドキュメントで確認

## 2. セキュリティプレースホルダーの放置

### パターン
- `// TODO: add authentication` のまま放置
- `password = "changeme"` のようなダミー値
- `CORS: *` のような過度に寛容な設定

### 対策
- TODO/FIXME検索をデプロイ前チェックに組み込む
- セキュリティ関連のTODOは即座に実装

## 3. 過剰実装（Over-engineering）

### パターン
- 要件にないデザインパターンの適用
- 不必要な抽象化レイヤー
- 使われない設定オプションの追加

### 対策
- 要件に対して実装が妥当か常に確認
- YAGNI（You Aren't Gonna Need It）原則を適用

## 4. テストのトートロジー

### パターン
- 実装コードをそのままコピーしたアサーション
- `expect(result).toBe(result)` のような無意味なテスト
- モックの設定がそのまま期待値になっている

### 対策
- テストが本当に何かを検証しているか確認
- 入力と期待出力を独立して定義

## 5. 不適切なエラーハンドリング

### パターン
- スタックトレースをそのままクライアントに返却
- 全てのエラーを500で返す
- エラーを握りつぶす（catch {} の中が空）

### 対策
- エラーレスポンスに内部情報を含めない
- エラー種別に応じた適切なHTTPステータスコード
- エラーはログに記録

## 6. SQL文字列結合

### パターン
- `SELECT * FROM users WHERE id = ${userId}`
- テンプレートリテラルでのクエリ組み立て

### 対策
- パラメタライズドクエリを必ず使用
- BigQuery: `@param` 形式のパラメータ
- Prisma: ORMのクエリビルダーを使用

## 7. ドメイン知識の誤り

### パターン
- ビジネスルールの誤解釈
- 業界固有の用語の誤用
- 計算ロジックの間違い

### 対策
- ビジネスロジックは必ず要件定義書と照合
- ドメインエキスパートのレビューを受ける
